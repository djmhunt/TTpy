
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plotting &#8212; PyDM 0.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyDM 0.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for plotting</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:Author: Dominic Hunt</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="c1">#matplotlib.use(&#39;Agg&#39;)</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">meshgrid</span><span class="p">,</span> <span class="n">fromfunction</span><span class="p">,</span> <span class="n">arange</span><span class="p">,</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nanmax</span><span class="p">,</span> <span class="n">nanmin</span><span class="p">,</span> <span class="n">log10</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">histogram</span><span class="c1">#, amin, amax</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">matplotlib.cm</span> <span class="k">import</span> <span class="n">get_cmap</span>
<span class="c1">#from mayavi import mlab #import quiver3d, flow</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">izip</span>
<span class="kn">from</span> <span class="nn">bisect</span> <span class="k">import</span> <span class="n">bisect_right</span>
<span class="kn">from</span> <span class="nn">vtkWriter.vtkStructured</span> <span class="k">import</span> <span class="n">VTK_XML_Serial_Structured</span>
<span class="kn">from</span> <span class="nn">vtkWriter.vtkUnstructured</span> <span class="k">import</span> <span class="n">VTK_XML_Serial_Unstructured</span>
<span class="kn">from</span> <span class="nn">vtkWriter.vtkCSV</span> <span class="k">import</span> <span class="n">VTK_CSV</span>

<span class="c1">### Define the different types of lines that will be plotted and their properties.</span>
<span class="c1"># Symbols</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span>
<span class="c1">## Symbols + line</span>
<span class="c1">#lps = [&#39;k&#39; + k for k in [&#39;,&#39;,&#39;.&#39;,&#39;o&#39;,&#39;^&#39;,&#39;v&#39;,&#39;&lt;&#39;,&#39;&gt;&#39;,&#39;s&#39;,&#39;+&#39;,&#39;x&#39;,&#39;D&#39;,&#39;d&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;h&#39;,&#39;H&#39;,&#39;p&#39;]]</span>
<span class="n">dots</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="n">scatterdots</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">]</span>
<span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
<span class="n">lines_width</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">large</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]</span>
<span class="n">large_line_width</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">large</span><span class="p">)</span>
<span class="n">lpl</span> <span class="o">=</span> <span class="n">lines</span> <span class="o">+</span> <span class="n">large</span>
<span class="n">lpl_linewidth</span> <span class="o">=</span> <span class="n">large_line_width</span> <span class="o">+</span> <span class="n">lines_width</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;0.85&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">large</span><span class="p">)</span>

<span class="c1">### Define the different colour maps to be considered</span>
<span class="c1"># Colour plot colour map</span>
<span class="n">defaultCMap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0000000001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)),</span>
               <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0000000001</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
                 <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0000000001</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))}</span>
<span class="c1"># local_cmap = matplotlib.colors.LinearSegmentedColormap(&#39;local_colormap&#39;,defaultCMap)</span>
<span class="n">wintermodCMap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0000000000000001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)),</span>
                 <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0000000000000001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
                 <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0000000000000001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))}</span>
<span class="n">wintermod_cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="s1">&#39;local_colormap_winter&#39;</span><span class="p">,</span><span class="n">wintermodCMap</span><span class="p">)</span>
<span class="n">local_cmap</span> <span class="o">=</span> <span class="n">wintermod_cmap</span>
<span class="c1"># local_cmap = get_cmap(&#39;winter&#39;)</span>

<span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span>
<span class="c1"># origin = &#39;upper&#39;</span>


<span class="c1">### Simple lineplot</span>
<div class="viewcode-block" id="lineplot"><a class="viewcode-back" href="../plotting.html#plotting.lineplot">[docs]</a><span class="k">def</span> <span class="nf">lineplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Produces a lineplot for multiple datasets witht he same x and y axis</span>

<span class="sd">    Uses ``axPlotlines`` for plotting</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array of length n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    labels : list of strings</span>
<span class="sd">        Description of each of the m datasets in ``Y``</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis properties, all optional, used in ``axPlotlines``.</span>
<span class="sd">        See ``axPlotlines`` for more details.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c1"># figsize=(8, 6), dpi=80)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">axPlotlines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">)</span>

    <span class="n">legend</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<span class="c1">### Response changes to different parameters</span>
<div class="viewcode-block" id="paramDynamics"><a class="viewcode-back" href="../plotting.html#plotting.paramDynamics">[docs]</a><span class="k">def</span> <span class="nf">paramDynamics</span><span class="p">(</span><span class="n">paramSet</span><span class="p">,</span> <span class="n">responses</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots response changes to different parameters</span>

<span class="sd">    Uses ``paramD1Dynamics``, ``paramD2Dynamics`` and ``paramD3Dynamics`` for plotting</span>
<span class="sd">    depending on number of parameters chosen. See their documentation for more</span>
<span class="sd">    detail.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    paramSet : dictionary</span>
<span class="sd">        The keys are the parameter names. The values are a list or array of</span>
<span class="sd">        floats, showing the different values of the parameter looked at.</span>
<span class="sd">    responses : array of floats</span>
<span class="sd">        The measure over which the parameters are being evaluated</span>
<span class="sd">    axisLabels : dict of strings or floats</span>
<span class="sd">        Axis information such as labels or axis title. See the different subfunctions for specific parameter list</span>
<span class="sd">    kwargs : dictionary</span>
<span class="sd">        kwargs depend on number of parameters chosen. See documentation for</span>
<span class="sd">        ``paramD1Dynamics``, ``paramD2Dynamics`` and ``paramD3Dynamics`` for kwarg lists</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object or, if ``paramD3Dynamics`` has been used, a ``vtkWriter`` object</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lparams</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">paramSet</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">paramSet</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">lparams</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axisLabels</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">paramD1Dynamics</span><span class="p">(</span><span class="n">paramSet</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                              <span class="n">responses</span><span class="p">,</span>
                              <span class="n">axisLabels</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">lparams</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">axisLabels</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">axisLabels</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">paramD2Dynamics</span><span class="p">(</span><span class="n">paramSet</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                              <span class="n">paramSet</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                              <span class="n">responses</span><span class="p">,</span>
                              <span class="n">axisLabels</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">lparams</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">axisLabels</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">axisLabels</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axisLabels</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;zLabel&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">paramD3Dynamics</span><span class="p">(</span><span class="n">paramSet</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                              <span class="n">paramSet</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                              <span class="n">paramSet</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                              <span class="n">responses</span><span class="p">,</span>
                              <span class="n">axisLabels</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="paramD1Dynamics"><a class="viewcode-back" href="../plotting.html#plotting.paramD1Dynamics">[docs]</a><span class="k">def</span> <span class="nf">paramD1Dynamics</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array of size m*n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis titles, all optional, containing:</span>

<span class="sd">        ``xlabel`` : `string`,</span>
<span class="sd">        ``ylabel`` : `string`,</span>
<span class="sd">        ``title`` : `string`,</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Parameter&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c1"># figsize=(8, 6), dpi=80)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">maxVal</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">minVal</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">minVal</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">minVal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">minVal</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maxVal</span> <span class="o">+=</span> <span class="p">(</span><span class="n">maxVal</span><span class="o">-</span><span class="n">minVal</span><span class="p">)</span><span class="o">/</span><span class="mf">100.0</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">minVal</span> <span class="o">!=</span> <span class="n">maxVal</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">minVal</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Plots&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;There is no variation in the &quot;</span> <span class="o">+</span> <span class="n">yLabel</span> <span class="o">+</span> <span class="s2">&quot; across &quot;</span> <span class="o">+</span> <span class="n">xLabel</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="paramD2Dynamics"><a class="viewcode-back" href="../plotting.html#plotting.paramD2Dynamics">[docs]</a><span class="k">def</span> <span class="nf">paramD2Dynamics</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of two dimensional plots superimposed on each other</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array of size m*n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    z : list or array of floats</span>
<span class="sd">        The magnitude values for the X,Y locations</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis titles, all optional, containing:</span>

<span class="sd">        ``xlabel`` : `string`,</span>
<span class="sd">        ``ylabel`` : `string`,</span>
<span class="sd">        ``title`` : `string`,</span>
<span class="sd">        ``cbLabel`` : `string`,</span>
<span class="sd">    contour : bool, optional</span>
<span class="sd">        Present the data as a contour plot using axContour. Default ``False``</span>
<span class="sd">    heatmap : bool, optional</span>
<span class="sd">        Presents the data as a square pixel heatmap using axImage. Default ``True``</span>
<span class="sd">    scatter : bool, optional</span>
<span class="sd">        Presents the data as a scatter plot using axScatter. Default ``False``</span>
<span class="sd">    minZ : float, optional</span>
<span class="sd">        Specifies what the minimum value of ``z`` should be set to. Default, ``0``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#Look in to fatfonts</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Parameter 1&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Parameter 2&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">CB_label</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cbLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">contour</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;contour&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">heatmap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;heatmap&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">scatter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">minZ</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;minZ&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="n">local_cmap</span><span class="p">)</span>

    <span class="n">zMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">zMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zMin</span> <span class="o">==</span> <span class="n">zMax</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Plots&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;There is no variation in the &quot;</span> <span class="o">+</span> <span class="n">yLabel</span> <span class="o">+</span> <span class="s2">&quot; across &quot;</span> <span class="o">+</span> <span class="n">xLabel</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">CB</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">scatter</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">SC</span><span class="p">,</span> <span class="n">CB</span> <span class="o">=</span> <span class="n">axScatter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">minZ</span><span class="o">=</span><span class="n">minZ</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="n">CB</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="n">CB_label</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contour</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">CS</span><span class="p">,</span> <span class="n">CB</span> <span class="o">=</span> <span class="n">axContour</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">minZ</span><span class="o">=</span><span class="n">minZ</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="n">CB</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="n">CB_label</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">heatmap</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">IM</span><span class="p">,</span> <span class="n">CB</span> <span class="o">=</span> <span class="n">axImage</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">minZ</span><span class="o">=</span><span class="n">minZ</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="n">CB</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="n">CB_label</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="paramD3Dynamics"><a class="viewcode-back" href="../plotting.html#plotting.paramD3Dynamics">[docs]</a><span class="k">def</span> <span class="nf">paramD3Dynamics</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Parameter 1&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Parameter 2&quot;</span><span class="p">)</span>
    <span class="n">zLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;zLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Parameter 3&quot;</span><span class="p">)</span>

    <span class="n">paraOut</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paraviewInput&quot;</span><span class="p">,</span> <span class="s2">&quot;CSV&quot;</span><span class="p">)</span>

    <span class="n">xMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">xMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">yMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">yMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">zMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">zMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">xS</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
    <span class="n">yS</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
    <span class="n">zS</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Z</span><span class="p">)))</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">xS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">xS</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">yS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">yS</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">zS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">zS</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">xJumps</span> <span class="o">=</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">yJumps</span> <span class="o">=</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span><span class="o">/</span><span class="n">dy</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">zJumps</span> <span class="o">=</span> <span class="p">(</span><span class="n">zMax</span> <span class="o">-</span> <span class="n">zMin</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1">#    X,Y,Z = meshgrid(x,y,z)</span>
<span class="c1">#    Xfleshed, Yfleshed, Zfleshed = meshgrid(linspace(xMin - dx, xMax + dx, xJumps),</span>
<span class="c1">#                                            linspace(yMin - dy, yMax + dy, yJumps),</span>
<span class="c1">#                                            linspace(zMin - dz, zMax + dz, zJumps))</span>
    <span class="n">Xfleshed</span><span class="p">,</span> <span class="n">Yfleshed</span><span class="p">,</span> <span class="n">Zfleshed</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">xJumps</span><span class="p">),</span>
                                            <span class="n">linspace</span><span class="p">(</span><span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">,</span> <span class="n">yJumps</span><span class="p">),</span>
                                            <span class="n">linspace</span><span class="p">(</span><span class="n">zMin</span><span class="p">,</span> <span class="n">zMax</span><span class="p">,</span> <span class="n">zJumps</span><span class="p">))</span>

<span class="c1">#    coPoints = [(a,b,c) for a,b,c in izip(X.flatten(),Y.flatten(),Z.flatten())]</span>
    <span class="n">coPoints</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)]</span>
    <span class="n">coGrid</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">coPoints</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">Xfleshed</span><span class="p">,</span> <span class="n">Yfleshed</span><span class="p">,</span> <span class="n">Zfleshed</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>

<span class="c1">#    coGridX = coGrid[1:,:,:] - coGrid[:-1,:,:]</span>
<span class="c1">#    coGridY = coGrid[:,1:,:] - coGrid[:,:-1,:]</span>
<span class="c1">#    coGridZ = coGrid[:,:,1:] - coGrid[:,:,:-1]</span>

    <span class="k">if</span> <span class="n">paraOut</span> <span class="o">==</span> <span class="s2">&quot;structured&quot;</span><span class="p">:</span>
        <span class="n">vtk_writer</span> <span class="o">=</span> <span class="n">VTK_XML_Serial_Structured</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">paraOut</span> <span class="o">==</span> <span class="s2">&quot;CSV&quot;</span><span class="p">:</span>
        <span class="n">vtk_writer</span> <span class="o">=</span> <span class="n">VTK_CSV</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">paraOut</span> <span class="o">==</span> <span class="s2">&quot;unstructured&quot;</span><span class="p">:</span>
        <span class="n">vtk_writer</span> <span class="o">=</span> <span class="n">VTK_XML_Serial_Unstructured</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">vtk_writer</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="n">Xfleshed</span><span class="p">,</span>
                        <span class="n">Yfleshed</span><span class="p">,</span>
                        <span class="n">Zfleshed</span><span class="p">,</span>
                        <span class="n">xLabel</span><span class="o">=</span><span class="n">xLabel</span><span class="p">,</span>
                        <span class="n">yLabel</span><span class="o">=</span><span class="n">yLabel</span><span class="p">,</span>
                        <span class="n">zLabel</span><span class="o">=</span><span class="n">zLabel</span><span class="p">,</span>
                        <span class="c1"># x_force = coGridX.flatten(),</span>
                        <span class="c1"># y_force = coGridY.flatten(),</span>
                        <span class="c1"># z_force = coGridZ.flatten(),</span>
                        <span class="n">radii</span><span class="o">=</span><span class="n">coGrid</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">vtk_writer</span></div>


<span class="c1">### Inputs compared to output probabilities</span>
<div class="viewcode-block" id="dataVsEvents"><a class="viewcode-back" href="../plotting.html#plotting.dataVsEvents">[docs]</a><span class="k">def</span> <span class="nf">dataVsEvents</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">eventLabel</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="n">dataFormatting</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Line plots of data with a line plot over the top</span>

<span class="sd">    Uses axPlotlines unless there are more than eight datasets in ``data``,</span>
<span class="sd">    at which point ``dataSpectrumVsEvents`` is called.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array of size m*n of floats</span>
<span class="sd">        The main datasets to be plotted</span>
<span class="sd">    events : array of size n of floats</span>
<span class="sd">        An variable that changes alongside ``data``, but whose values are</span>
<span class="sd">        meaningful for all sets in data</span>
<span class="sd">    labels : list of strings</span>
<span class="sd">        Description of each of the m datasets in data</span>
<span class="sd">    eventLabel : string</span>
<span class="sd">        A description of the meaning of events</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis properties, all optional, containing those in</span>
<span class="sd">        ``axPlotlines`` as well as:</span>
<span class="sd">        ``y2label`` : `string` The label of the scale of events</span>
<span class="sd">    dataFormatting : dictionary of string keys and values as lists of strings or floats</span>
<span class="sd">        A dictionary of properties for each data line to be plotted, all optional, if there are fewer than 8 datasets.</span>
<span class="sd">        The optional parameters are those defined in axPlotlines.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">dataShape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataShape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataShape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dataShape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">dataSpectrumVsEvents</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">eventLabel</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c1"># figsize=(8, 6), dpi=80)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">y2Label</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;y2Label&quot;</span><span class="p">,</span> <span class="s2">&quot;Event value&quot;</span><span class="p">)</span>

    <span class="n">eventTimes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eventX</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">eventTimes</span><span class="p">]</span>

    <span class="n">axPlotlines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">eventTimes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="n">dataFormatting</span><span class="o">=</span><span class="n">dataFormatting</span><span class="p">)</span>

    <span class="n">axb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">pltLine</span> <span class="o">=</span> <span class="n">axb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eventX</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">eventLabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="n">axb</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">bottom</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">top</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">))</span>

    <span class="n">axb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y2Label</span><span class="p">)</span>

    <span class="n">legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axb</span><span class="p">)</span>

    <span class="c1">#fig.tight_layout(pad=0.6, w_pad=0.5, h_pad=1.0)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="dataSpectrumVsEvents"><a class="viewcode-back" href="../plotting.html#plotting.dataSpectrumVsEvents">[docs]</a><span class="k">def</span> <span class="nf">dataSpectrumVsEvents</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">eventLabel</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spectogram of data with a line plot over the top</span>

<span class="sd">    Uses axSpectrum for the spectrogram</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array of size m*n of floats</span>
<span class="sd">        The main datasets to be plotted</span>
<span class="sd">    events : array of size n of floats</span>
<span class="sd">        An variable that changes alongside ``data``, but whose values are</span>
<span class="sd">        meaningful for all sets in data</span>
<span class="sd">    eventLabel : string</span>
<span class="sd">        A description of the meaning of events</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis properties, all optional, containing those in</span>
<span class="sd">        ``axSpectrum`` as well as:</span>
<span class="sd">        ``y2label`` : `string` The label of the scale of events</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">y2Label</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;y2Label&quot;</span><span class="p">,</span> <span class="s2">&quot;Event value&quot;</span><span class="p">)</span>

    <span class="n">eventX</span> <span class="o">=</span> <span class="n">fromfunction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">),))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c1"># figsize=(8, 6), dpi=80)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">axSpectrum</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">)</span>

    <span class="n">axb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">pltLine</span> <span class="o">=</span> <span class="n">axb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eventX</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">eventLabel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="n">axb</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">bottom</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">top</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">))</span>

    <span class="n">axb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y2Label</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>

<span class="c1">###</span>

<div class="viewcode-block" id="scatterplot_matrix"><a class="viewcode-back" href="../plotting.html#plotting.scatterplot_matrix">[docs]</a><span class="k">def</span> <span class="nf">scatterplot_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a scatterplot matrix of subplots.  Each row of &quot;data&quot; is plotted</span>
<span class="sd">    against other rows, resulting in a nrows by nrows grid of subplots with the</span>
<span class="sd">    diagonal subplots labeled with &quot;names&quot;.  Additional keyword arguments are</span>
<span class="sd">    passed on to matplotlib&#39;s &quot;plot&quot; command. Returns the matplotlib figure</span>
<span class="sd">    object containg the subplot grid.</span>
<span class="sd">    Modified from https://stackoverflow.com/questions/7941207/is-there-a-function-to-make-scatterplot-matrices-in-matplotlib</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numvars</span><span class="p">,</span> <span class="n">numdata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">numvars</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">numvars</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">xpos</span> <span class="o">=</span> <span class="n">i</span><span class="o">//</span><span class="n">nrows</span>
    <span class="n">ypos</span> <span class="o">=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="n">i</span><span class="o">%</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ypos</span><span class="p">,</span> <span class="n">xpos</span><span class="p">]</span>

    <span class="n">groupData</span><span class="o">.</span><span class="n">ActionProb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;alpha: </span><span class="si">%2.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;beta: </span><span class="si">%2.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
        <span class="c1"># Set up ticks only on one side for the &quot;edge&quot; subplots...</span>
        <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ax</span><span class="o">.</span><span class="n">is_last_col</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">is_first_row</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ax</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


    <span class="c1"># FIX #2: if numvars is odd, the bottom right corner plot doesn&#39;t have the</span>
    <span class="c1"># correct axes limits, so we pull them from other axes</span>
    <span class="k">if</span> <span class="n">numvars</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">xlimits</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylimits</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlimits</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylimits</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<span class="c1">### Pandas realted plotting functions</span>
<div class="viewcode-block" id="pandasPlot"><a class="viewcode-back" href="../plotting.html#plotting.pandasPlot">[docs]</a><span class="k">def</span> <span class="nf">pandasPlot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axisLabels</span> <span class="o">=</span> <span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A wrapper round a pandas plotting function</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pandas dataSeries</span>
<span class="sd">    axisLabels : dictionary, optional</span>
<span class="sd">        A dictionary of axis properties, all optional, containing:</span>

<span class="sd">        ``xlabel`` : `string`,</span>
<span class="sd">        ``ylabel`` : `string`,</span>
<span class="sd">        ``title`` : `string`,</span>
<span class="sd">        ``yMin`` : `float`,</span>
<span class="sd">        ``yMax`` : `float`,</span>
<span class="sd">        ``xMin`` : `float`,</span>
<span class="sd">        ``xMax`` : `float`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure object</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Inspired by axPlotlines</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Event&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1">#    yMin = axisLabels.pop(&quot;yMin&quot;, nanmin(Y))</span>
<span class="c1">#    yMax = axisLabels.pop(&quot;yMax&quot;, nanmax(Y))</span>
<span class="c1">#    xMin = axisLabels.pop(&quot;xMin&quot;, min(x))</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span></div>

<span class="c1">### Background to plotting functions</span>
<span class="c1"># Taking the final stages of plotting and providing a nice interface to do it all in one call</span>
<span class="c1"># rather than a few dozen</span>


<div class="viewcode-block" id="axScatter"><a class="viewcode-back" href="../plotting.html#plotting.axScatter">[docs]</a><span class="k">def</span> <span class="nf">axScatter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">minZ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">local_cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces a scatter plot on the axis with the colour of the dots being a</span>
<span class="sd">    third axis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axis object</span>
<span class="sd">    X : array of size m*n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    z : list or array of floats</span>
<span class="sd">        The magnitude values for the X,Y locations</span>
<span class="sd">    minZ : float, optional</span>
<span class="sd">        The lowest valid value of the colour map</span>
<span class="sd">    CB : matplotlib colorbar or ``None``, optional</span>
<span class="sd">        The colorbar object for the figure if one has already been created. Default is ``None``</span>
<span class="sd">    CB_label : string, optional</span>
<span class="sd">        The colour bar label. Unused in this instance</span>
<span class="sd">    cmap : matplotlib colormap object or name of known colormap</span>
<span class="sd">        The colormap to be used by this to represent the z data. Default local_cmap defined in this plotting module</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sc : matplotlib scatter object</span>
<span class="sd">    CB : matplotlib colorbar</span>
<span class="sd">        The colorbar object for the figure if one has already been created</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">maxZ</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="c1"># For changing the dot size</span>
    <span class="c1"># minC = 1</span>
    <span class="c1"># maxC = 301</span>
    <span class="c1"># zScale = (maxC - minC) / float(maxZ - minZ)</span>
    <span class="c1"># C = minC + (z-nanmin(z))*zScale</span>

    <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;face&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">CB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">CB</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">CB</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">CB_label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Check if the range needs increasing</span>
        <span class="n">oldCMin</span><span class="p">,</span> <span class="n">oldCMax</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()</span>
        <span class="n">minZ</span> <span class="o">=</span> <span class="n">oldCMin</span> <span class="k">if</span> <span class="n">oldCMin</span> <span class="o">&lt;</span> <span class="n">minZ</span> <span class="k">else</span> <span class="n">minZ</span>
        <span class="n">maxZ</span> <span class="o">=</span> <span class="n">oldCMax</span> <span class="k">if</span> <span class="n">oldCMax</span> <span class="o">&gt;</span> <span class="n">maxZ</span> <span class="k">else</span> <span class="n">maxZ</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="n">minZ</span><span class="p">,</span> <span class="n">maxZ</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">sc</span><span class="p">,</span> <span class="n">CB</span></div>


<div class="viewcode-block" id="axImage"><a class="viewcode-back" href="../plotting.html#plotting.axImage">[docs]</a><span class="k">def</span> <span class="nf">axImage</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">minZ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">local_cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces an image on the axis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axis object</span>
<span class="sd">    X : array of size m*n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    z : list or array of floats</span>
<span class="sd">        The magnitude values for the X,Y locations</span>
<span class="sd">    minZ : float, optional</span>
<span class="sd">        The lowest valid value of the colour map</span>
<span class="sd">    CB : matplotlib colorbar or ``None``, optional</span>
<span class="sd">        The colorbar object for the figure if one has already been created. Default is ``None``</span>
<span class="sd">    CB_label : string, optional</span>
<span class="sd">        The colour bar label</span>
<span class="sd">    cmap : matplotlib colormap object or name of known colormap</span>
<span class="sd">        The colormap to be used by this to represent the z data. Default local_cmap defined in this plotting module</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    IM : matplotlib image object</span>
<span class="sd">    CB : matplotlib colorbar</span>
<span class="sd">        The colorbar object for the figure if one has already been created</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">xMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">yMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">yMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">xS</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
    <span class="n">yS</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">xS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">xS</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">yS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">yS</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">xJumps</span> <span class="o">=</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">yJumps</span> <span class="o">=</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span><span class="o">/</span><span class="n">dy</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="n">xMinIm</span> <span class="o">=</span> <span class="n">xMin</span> <span class="o">-</span> <span class="n">dx</span>
    <span class="n">xMaxIm</span> <span class="o">=</span> <span class="n">xMax</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="n">yMinIm</span> <span class="o">=</span> <span class="n">yMin</span> <span class="o">-</span> <span class="n">dy</span>
    <span class="n">yMaxIm</span> <span class="o">=</span> <span class="n">yMax</span> <span class="o">+</span> <span class="n">dy</span>

<span class="c1">#    X,Y = meshgrid(x,y)</span>
    <span class="n">Xfleshed</span><span class="p">,</span> <span class="n">Yfleshed</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="n">xMinIm</span><span class="p">,</span> <span class="n">xMaxIm</span><span class="p">,</span> <span class="n">xJumps</span><span class="p">),</span> <span class="n">linspace</span><span class="p">(</span><span class="n">yMinIm</span><span class="p">,</span> <span class="n">yMaxIm</span><span class="p">,</span> <span class="n">yJumps</span><span class="p">))</span>

<span class="c1">#    zPoints = [(a,b) for a,b in izip(X.flatten(),Y.flatten())]</span>
    <span class="n">zPoints</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)]</span>
    <span class="n">gridZ</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">zPoints</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">(</span><span class="n">Xfleshed</span><span class="p">,</span> <span class="n">Yfleshed</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>

<span class="c1">#    qm = plt.pcolormesh(gridZ, cmap = local_cmap)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gridZ</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                   <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                   <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xMinIm</span><span class="p">,</span> <span class="n">xMaxIm</span><span class="p">,</span> <span class="n">yMinIm</span><span class="p">,</span> <span class="n">yMaxIm</span><span class="p">],</span>
                   <span class="n">vmin</span><span class="o">=</span><span class="n">minZ</span><span class="p">,</span>
                   <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">CB</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">CB</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">CB_label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Check if the range needs increasing</span>
        <span class="n">oldCMin</span><span class="p">,</span> <span class="n">oldCMax</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()</span>
        <span class="n">minZ</span> <span class="o">=</span> <span class="n">oldCMin</span> <span class="k">if</span> <span class="n">oldCMin</span> <span class="o">&lt;</span> <span class="n">minZ</span> <span class="k">else</span> <span class="n">minZ</span>
        <span class="n">maxZ</span> <span class="o">=</span> <span class="n">oldCMax</span> <span class="k">if</span> <span class="n">oldCMax</span> <span class="o">&gt;</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="k">else</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="n">minZ</span><span class="p">,</span> <span class="n">maxZ</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">im</span><span class="p">,</span> <span class="n">CB</span></div>


<div class="viewcode-block" id="axContour"><a class="viewcode-back" href="../plotting.html#plotting.axContour">[docs]</a><span class="k">def</span> <span class="nf">axContour</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">minZ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">local_cmap</span><span class="p">,</span> <span class="n">maxContours</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces a contour plot on the axis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axis object</span>
<span class="sd">    X : array of size m*n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    z : list or array of floats</span>
<span class="sd">        The magnitude values for the X,Y locations</span>
<span class="sd">    minZ : float, optional</span>
<span class="sd">        The value of the lowest contour</span>
<span class="sd">    CB : matplotlib colorbar or ``None``, optional</span>
<span class="sd">        The colorbar object for the figure if one has already been created. Default is ``None``</span>
<span class="sd">    CB_label : string, optional</span>
<span class="sd">        The colour bar label</span>
<span class="sd">    cmap : matplotlib colormap object or name of known colormap</span>
<span class="sd">        The colormap to be used by this to represent the z data. Default local_cmap defined in this plotting module</span>
<span class="sd">    maxContours : int, optional</span>
<span class="sd">        The maximum number of contours - 2 that can be shown. Default 20</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CS : matplotlib contour object</span>
<span class="sd">    CB : matplotlib colorbar</span>
<span class="sd">        The colorbar object for the figure if one has already been created</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">xMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">yMin</span> <span class="o">=</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">yMax</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">maxZ</span> <span class="o">=</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="n">xi</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">ZGrid</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span>
                     <span class="n">z</span><span class="p">,</span>
                     <span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">yi</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span>
                     <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
    <span class="n">XGrid</span><span class="p">,</span> <span class="n">YGrid</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">maxZ</span> <span class="o">==</span> <span class="n">minZ</span><span class="p">:</span>
        <span class="n">maxZ</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">zSorted</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">diffSort</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">zSorted</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">zSorted</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">usableDiffs</span> <span class="o">=</span> <span class="n">diffSort</span><span class="p">[</span><span class="n">diffSort</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="n">diffSort</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)]</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">usableDiffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">potentialJumps</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxZ</span> <span class="o">-</span> <span class="n">minZ</span><span class="p">)</span><span class="o">/</span><span class="n">dz</span>
    <span class="k">if</span> <span class="n">potentialJumps</span> <span class="o">&gt;</span> <span class="n">maxContours</span><span class="p">:</span>
        <span class="n">zJumps</span> <span class="o">=</span> <span class="n">maxContours</span>
        <span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxZ</span> <span class="o">-</span> <span class="n">minZ</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">zJumps</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zJumps</span> <span class="o">=</span> <span class="n">potentialJumps</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">minZ</span><span class="p">,</span> <span class="n">maxZ</span><span class="o">+</span><span class="n">dz</span><span class="p">,</span> <span class="n">zJumps</span><span class="p">)</span>

    <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">XGrid</span><span class="p">,</span> <span class="n">YGrid</span><span class="p">,</span> <span class="n">ZGrid</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span>
                    <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                    <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">],</span>
                    <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span>
               <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span>  <span class="c1"># [1::2],  # label every second level</span>
               <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%2.1f</span><span class="s1">&#39;</span><span class="p">,</span>
               <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
               <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1">#    CS.cmap.set_under(&#39;yellow&#39;)</span>
<span class="c1">#    CS.cmap.set_over(&#39;cyan&#39;)</span>
    <span class="n">CS</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">CB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">CB</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">CB</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">CB_label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Check if the range needs increasing</span>
        <span class="n">oldCMin</span><span class="p">,</span> <span class="n">oldCMax</span> <span class="o">=</span> <span class="n">CS</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()</span>
        <span class="n">minZ</span> <span class="o">=</span> <span class="n">oldCMin</span> <span class="k">if</span> <span class="n">oldCMin</span> <span class="o">&lt;</span> <span class="n">minZ</span> <span class="k">else</span> <span class="n">minZ</span>
        <span class="n">maxZ</span> <span class="o">=</span> <span class="n">oldCMax</span> <span class="k">if</span> <span class="n">oldCMax</span> <span class="o">&gt;</span> <span class="n">maxZ</span> <span class="k">else</span> <span class="n">maxZ</span>
        <span class="n">CS</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="n">minZ</span><span class="p">,</span> <span class="n">maxZ</span><span class="p">])</span>

<span class="c1">#    # Improving the position of the contour bar legend</span>
<span class="c1">#    l,b,w,h = ax.get_position().bounds</span>
<span class="c1">#    ll,bb,ww,hh = CB.ax.get_position().bounds</span>
<span class="c1">#    CB.ax.set_position([ll, b+0.1*h, ww, h*0.8])</span>

    <span class="k">return</span> <span class="n">CS</span><span class="p">,</span> <span class="n">CB</span></div>


<div class="viewcode-block" id="axQuiver"><a class="viewcode-back" href="../plotting.html#plotting.axQuiver">[docs]</a><span class="k">def</span> <span class="nf">axQuiver</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dX</span><span class="p">,</span> <span class="n">dY</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="n">CB_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Quiver plot or flow plot depending on your terminology</span>

<span class="sd">    A work in progress</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axis object</span>
<span class="sd">    X : array of size m*n of floats</span>
<span class="sd">        The horizontal axis locations of the points</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">        The vertical axis locations of the points</span>
<span class="sd">    dX : array of size m*n of floats</span>
<span class="sd">        The horizontal axis magnitudes for the arrows</span>
<span class="sd">    dY : array of size m*n of floats</span>
<span class="sd">        The vertical axis magnitudes for the arrows</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis titles, all optional, containing:</span>

<span class="sd">        ``xlabel`` : `string`,</span>
<span class="sd">        ``ylabel`` : `string`,</span>
<span class="sd">        ``title`` : `string`,</span>
<span class="sd">    CB_label : basestring</span>
<span class="sd">        The label of the colourbar. Default is empty</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Work in progress</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Event&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dX</span><span class="p">,</span> <span class="n">dY</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">local_cmap</span><span class="p">)</span>

    <span class="n">CBI</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">CBI</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">CB_label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span></div>


<div class="viewcode-block" id="axPlotlines"><a class="viewcode-back" href="../plotting.html#plotting.axPlotlines">[docs]</a><span class="k">def</span> <span class="nf">axPlotlines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">,</span> <span class="n">dataFormatting</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces a set of lineplots on the axis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axis object</span>
<span class="sd">    x : array of length n of floats</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    labels : list of strings</span>
<span class="sd">        Description of each of the m datasets in ``Y``</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis properties, all optional, containing:</span>

<span class="sd">        ``xlabel`` : `string`,</span>
<span class="sd">        ``ylabel`` : `string`,</span>
<span class="sd">        ``title`` : `string`,</span>
<span class="sd">        ``yMin`` : `float`,</span>
<span class="sd">        ``yMax`` : `float`,</span>
<span class="sd">        ``xMin`` : `float`,</span>
<span class="sd">        ``xMax`` : `float`</span>
<span class="sd">    dataFormatting : dictionary of string keys and values as lists of strings or floats</span>
<span class="sd">        A dictionary of properties for each line to be plotted, all optional. See the start of the plotting module to</span>
<span class="sd">        see all options for each option. Each list should be at least as long as ``m`` in ``Y``</span>

<span class="sd">        ``linetype`` : If the line is dotted and if so how</span>
<span class="sd">        ``colours`` : The colour of each line</span>
<span class="sd">        ``linewidth`` : The thickness of the lines</span>
<span class="sd">        ``markersize`` : The size of the dots at each datapoint.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Event&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">lineType</span> <span class="o">=</span> <span class="n">dataFormatting</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linetype&#39;</span><span class="p">,</span> <span class="n">lpl</span><span class="p">)</span>
    <span class="n">colourList</span> <span class="o">=</span> <span class="n">dataFormatting</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;colours&#39;</span><span class="p">,</span> <span class="n">colours</span><span class="p">)</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">dataFormatting</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="n">lpl_linewidth</span><span class="p">)</span>
    <span class="n">markersize</span> <span class="o">=</span> <span class="n">dataFormatting</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markersize&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lpl</span><span class="p">))])</span>


    <span class="n">yMin</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yMin&quot;</span><span class="p">,</span> <span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
    <span class="n">yMax</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yMax&quot;</span><span class="p">,</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
    <span class="n">xMin</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xMin&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">Ys</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">xMax</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xMax&quot;</span><span class="p">,</span> <span class="n">Ys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">pltLines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">lineType</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colourList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">xMax</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xMax&quot;</span><span class="p">,</span> <span class="n">Ys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
            <span class="n">pltLines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lineType</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colourList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="axSpectrum"><a class="viewcode-back" href="../plotting.html#plotting.axSpectrum">[docs]</a><span class="k">def</span> <span class="nf">axSpectrum</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">axisLabels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces a spectrogram-like plot on the axis</span>

<span class="sd">    This is made by creating a histogram for each x-axis element.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axis object</span>
<span class="sd">    Y : array of size m*n of floats</span>
<span class="sd">    axisLabels : dictionary</span>
<span class="sd">        A dictionary of axis properties, all optional, containing:</span>

<span class="sd">        ``xlabel`` : `string`,</span>
<span class="sd">        ``ylabel`` : `string`,</span>
<span class="sd">        ``title`` : `string`,</span>
<span class="sd">        ``yMin`` : `float`,</span>
<span class="sd">        ``yMax`` : `float`,</span>
<span class="sd">        ``xMin`` : `float`,</span>
<span class="sd">        ``xMax`` : `float`,</span>
<span class="sd">        ``bins`` : `int`,</span>
<span class="sd">        ``probDensity`` : `binary`</span>
<span class="sd">        Sets if the histogram type is showing frequency or probability</span>
<span class="sd">        density.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Events&quot;</span><span class="p">)</span>
    <span class="n">yLabel</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;Density across parameter range&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">minVal</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yMin&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">maxVal</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;yMax&quot;</span><span class="p">,</span> <span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
    <span class="n">xMin</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xMin&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">xMax</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;xMax&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="n">bins</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bins&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">probDensity</span> <span class="o">=</span> <span class="n">axisLabels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;probDensity&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="c1"># Create this histogram-like data</span>
    <span class="n">histData</span> <span class="o">=</span> <span class="p">[</span><span class="n">histogram</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minVal</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">probDensity</span><span class="p">:</span>
        <span class="n">plotData</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">histData</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plotData</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">histData</span><span class="p">])</span>

    <span class="c1"># Since we are calculating a probability density and the bins are less than 1 in size we needed</span>
    <span class="c1"># To multiply by the bin size to get the actual probability of each bin</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">plotData</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">wintermod_cmap</span><span class="p">,</span>
                   <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                   <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">minVal</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">],</span>
                   <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">probDensity</span><span class="p">:</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Probability density&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Bin probability&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yLabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="legend"><a class="viewcode-back" href="../plotting.html#plotting.legend">[docs]</a><span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="o">*</span><span class="n">axis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a legend to each subplot in a figure</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : a list of matplotlib axis objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">embed</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;embed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">lineList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pltLabels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>

        <span class="n">line</span><span class="p">,</span> <span class="n">pltLabel</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">lineList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">pltLabels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pltLabel</span><span class="p">)</span>

        <span class="c1"># for plotting the legend outside the box</span>
        <span class="c1"># Shrink current axis&#39;s height by 10% on the bottom</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                         <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">lineList</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># For plotting the legend inside the plot</span>
    <span class="k">if</span> <span class="n">embed</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lineList</span><span class="p">,</span> <span class="n">pltLabels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># for plotting the legend outside the box</span>
        <span class="c1"># Put a legend below current axis</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lineList</span><span class="p">,</span> <span class="n">pltLabels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">),</span>
                  <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="addPoint"><a class="viewcode-back" href="../plotting.html#plotting.addPoint">[docs]</a><span class="k">def</span> <span class="nf">addPoint</span><span class="p">(</span><span class="n">xPos</span><span class="p">,</span> <span class="n">yPos</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>


<span class="sd">    Inspired by http://stackoverflow.com/questions/9215658/plot-a-circle-with-pyplot</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xPos</span>
<span class="sd">    yPos</span>
<span class="sd">    ax</span>
<span class="sd">    colour</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">xPos</span><span class="p">,</span> <span class="n">yPos</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colour</span><span class="p">)</span></div>


<div class="viewcode-block" id="addCircle"><a class="viewcode-back" href="../plotting.html#plotting.addCircle">[docs]</a><span class="k">def</span> <span class="nf">addCircle</span><span class="p">(</span><span class="n">xPos</span><span class="p">,</span> <span class="n">yPos</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">circleSize</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">colour</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">]):</span>

    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">xPos</span><span class="p">,</span> <span class="n">yPos</span><span class="p">,</span> <span class="n">circleSize</span><span class="p">,</span> <span class="n">colour</span><span class="p">):</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span></div>

<span class="c1"># if __name__ == &#39;__main__&#39;:</span>

<span class="c1">#    x = array([1, 2, 4])</span>
<span class="c1">#    y = array([0.1, 0.2, 0.3])</span>
<span class="c1">#    z = array([0.3, 0.4, 0.5])</span>
<span class="c1">#     x = array([1, 2, 3])</span>
<span class="c1">#     y = array([4, 5, 6])</span>
<span class="c1">#     z = array([7, 8, 9])</span>
<span class="c1">#     f = array([1, 2, 3, 2, 3, 4, 3, 4, 5, 2, 3, 4, 3, 4, 5, 4, 5, 6, 3, 4, 5, 4, 5, 6, 5, 6, 7])</span>
<span class="c1">#</span>
<span class="c1">#     fig = paramD3Dynamics(x, y, z, f, &#39;TestX&#39;, &#39;TestY&#39;, &#39;TestZ&#39;)</span>
<span class="c1">#     fig.outputTrees(&quot;outputs/testDataStruc&quot;)</span>

<span class="c1">#    fig = paramD2Dynamics(x,y,z, &#39;TestX&#39;, &#39;TestY&#39;, contour=False, heatmap = False, scatter = True)</span>

<span class="c1">#    X = array([[1, 2, 4], [1, 2, 4], [1, 2, 4]])</span>
<span class="c1">#    Y = array([[ 0.1,  0.1,  0.1], [ 0.2,  0.2,  0.2], [ 0.3,  0.3,  0.3]])</span>
<span class="c1">#    Z = array([[2, 1, 1], [0, 2, 1], [0, 0, 1]])</span>

<span class="c1">#    fig = plt.figure()  # figsize=(8, 6), dpi=80)</span>
<span class="c1">#    ax = fig.add_subplot(111)</span>
<span class="c1">#</span>
<span class="c1">#    minZ = nanmin(Z)-1</span>
<span class="c1">#    maxZ = nanmax(Z)+2</span>
<span class="c1">#    levels = arange(minZ,maxZ,2)</span>
<span class="c1">#    area = [nanmin(X),nanmax(X),nanmin(Y),nanmax(Y)]</span>
<span class="c1">#</span>
<span class="c1">#    qm = plt.pcolormesh(X, Y, Z,</span>
<span class="c1">#                   cmap = local_cmap)</span>
<span class="c1">#    CBI = plt.colorbar(qm, orientation=&#39;horizontal&#39;, shrink=0.8)</span>
<span class="c1">#    CBI.set_label(&quot;Time to decision&quot;)</span>
<span class="c1">#</span>
<span class="c1">#    plt.gcf().set_size_inches(6, 6)</span>
<span class="c1">#</span>
<span class="c1">#    plt.show()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyDM 0.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Dominic Hunt.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.
    </div>
  </body>
</html>